"use strict";(self.webpackChunkmwtracks=self.webpackChunkmwtracks||[]).push([[212],{1557:function(e,t,n){n.r(t),n.d(t,{default:function(){return ge}});var s=n(29439),i=n(16554),a=(n(64013),n(5531)),r=n(47313),l=n(22408),u=n(58467),o=n(30242),c=n(9038),d=n(16787),p=n(99720),f=n(31335),v=n(52418),x=n(65168),h=n(14629),m=n(38954),Z=n(39300),j=n(94058),g=(0,c.UY)({tasks:d.ZP,episodes:p.ZP,sequences:f.ZP,shots:v.ZP,status:m.ZP,steps:x.ZP,assets:h.ZP,users:Z.ZP,utilSteps:j.ZP}),b=n(22116),y=n(74165),S=n(93433),k=n(1413),C=n(15861),w=n(56573),I=n(83508),N=n(75908),q=n(19536),_=n(61689),A=n(20527),E=n(83213),T=n(63366),L=n(87462),F=n(2197),O=n(21921),P=n(51195),V=n(17592),U=n(77342),D=n(77430),R=n(32298);function M(e){return(0,R.Z)("MuiListItemAvatar",e)}(0,D.Z)("MuiListItemAvatar",["root","alignItemsFlexStart"]);var z=n(46417),K=["className"],W=(0,V.ZP)("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,"flex-start"===n.alignItems&&t.alignItemsFlexStart]}})((function(e){var t=e.ownerState;return(0,L.Z)({minWidth:56,flexShrink:0},"flex-start"===t.alignItems&&{marginTop:8})})),B=r.forwardRef((function(e,t){var n=(0,U.Z)({props:e,name:"MuiListItemAvatar"}),s=n.className,i=(0,T.Z)(n,K),a=r.useContext(P.Z),l=(0,L.Z)({},n,{alignItems:a.alignItems}),u=function(e){var t=e.alignItems,n=e.classes,s={root:["root","flex-start"===t&&"alignItemsFlexStart"]};return(0,O.Z)(s,M,n)}(l);return(0,z.jsx)(W,(0,L.Z)({className:(0,F.Z)(u.root,s),ownerState:l,ref:t},i))})),G=n(63585),J=n(32729),H=n(31095),Q=n(66149),$=n(4117),X=n(96467),Y=n(71263),ee=n(47131),te=n(30467),ne=n(9289),se=n(61113),ie=n(18390),ae=n(10546),re=n.n(ae),le=n(49614),ue=n.p+"static/media/sample_create_task.9cee31524a77fd5742bd.csv",oe=n.p+"static/media/sample_update_task.3d2fdbf5f2bce69f0122.csv",ce={name:"",status:null,priority:"low",reviewer:null,version_number:1,project:null,asset:null,episode:null,sequence:null,shot:null,step:null,task_users:[]};var de=function(e){var t,n,i,a,o=(0,l.I0)(),c=(0,u.UO)(),x=e.taskDialog,m=e.taskEntities,Z=e.userTasks,g=e.users,b=e.statuses,T=e.episodeIds,L=e.sequenceIds,F=e.shotIds,O=e.assetIds,P=(e.taskIds,(0,r.useState)(null)),V=(0,s.Z)(P,2),U=V[0],D=V[1],R=(0,r.useState)([]),M=(0,s.Z)(R,2),K=M[0],W=M[1],ae=["Ready To Start","In Progress"],de=e.utilSteps&&Object.values(e.utilSteps).map((function(e){return e.name}))||[],pe=le.Z.range(1,20,.25).map((function(e){return e.toString()})),fe=(0,r.useState)(null),ve=(0,s.Z)(fe,2),xe=ve[0],he=ve[1],me=(0,l.v9)((function(e){return e.core.projects.entities})),Ze=null===c||void 0===c||null===(t=c.uid)||void 0===t?void 0:t.split(":")[0].toLowerCase(),je=me&&(null===(n=me[Ze])||void 0===n?void 0:n.is_episodic),ge=b?le.Z.find(b,{name:"Ready To Start"}):null,be=(0,r.useState)(null),ye=(0,s.Z)(be,2),Se=ye[0],ke=ye[1],Ce=(0,I.cI)(ce),we=Ce.form,Ie=Ce.handleChange,Ne=Ce.setForm,qe=Ce.setInForm,_e=Ce.resetForm,Ae=(0,r.useState)(""),Ee=(0,s.Z)(Ae,2),Te=Ee[0],Le=Ee[1],Fe=(0,r.useState)(null),Oe=(0,s.Z)(Fe,2),Pe=Oe[0],Ve=Oe[1],Ue=(0,r.useState)([]),De=(0,s.Z)(Ue,2),Re=De[0];function Me(e){return ze.apply(this,arguments)}function ze(){return(ze=(0,C.Z)((0,y.Z)().mark((function e(t){var n;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/v1/entity/tasks/"+t+"/",e.next=3,w.Z.get(n).then((function(e){return 200===e.status})).catch((function(e){return console.error(e),!1}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}De[1];var Ke=(0,r.useCallback)((function(){_e(),"edit"===x.type&&x.data&&(Ne((0,k.Z)({},x.data)),"undefined"==typeof x.data.task_users&&o((0,d.X5)(x.data.uid))),"new"===x.type&&(_e(),Ne((0,k.Z)((0,k.Z)({},ce),x.data)),qe("project",Ze),qe("status",null===ge||void 0===ge?void 0:ge.id))}),[x.data,x.type,Ne]);function We(){return(We=(0,C.Z)((0,y.Z)().mark((function e(t){var n,s,i,a,r,l,u;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return qe("step",n=U+":"+t),s=[],e.prev=3,e.next=6,w.Z.get("/api/v1/entity/steps/"+n+"/tasks/");case 6:return i=e.sent,e.next=9,i.data;case 9:a=e.sent,s=a.sort((function(e,t){return t.version_number-e.version_number})),e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(3),console.log("Step Not found ..."),o((0,ie.PV)({message:"Step ("+n+") not found, please create step first !",variant:"error"})),e.abrupt("return");case 18:if(r="Task_v1",!(s.length>0)){e.next=27;break}if(l=s[0].version_number,!ae.includes(b[s[0].status])){e.next=24;break}return qe("name",""),e.abrupt("return",!1);case 24:u=parseInt(l)+1,r="Task_v"+u,qe("version_number",u);case 27:qe("name",r);case 28:case"end":return e.stop()}}),e,null,[[3,13]])})))).apply(this,arguments)}function Be(){qe("name",null),ke(null),D(null),Ve(null),Le(null)}function Ge(){"edit"===x.type?o((0,d.W)()):"new"===x.type?o((0,d.pi)()):"csvCreate"===x.type?o((0,d.sN)()):o((0,d.V3)()),Be(),he(null)}function Je(e){if(e.preventDefault(),"csvCreate"===x.type&&Re.length>0)o((0,d.Sv)(Re));else if("csvUpdate"===x.type&&Re.length>0)o((0,d.Q$)({multipleTaskList:Re,project:Ze}));else if("multiple"===x.type&&x.data&&x.data.length>0)x.data.map((function(e){var t=re()(ce,we);t.id=e,t.task_users&&t.task_users.length>0?t.task_users=t.task_users.map((function(e){return(0,k.Z)((0,k.Z)({},e),{task:t.id})})):delete t.task_users,Me(t.id).then((function(e){e?(console.info("URL exists",t.id),o((0,d.Q$)({multipleTaskList:t,project:Ze}))):(console.info("URL does not exist",t.id),t.step=m[t.id].step,delete t.uid,o((0,d.Sv)(t)))})).catch((function(e){console.error(e)}))}));else if("new"===x.type)o((0,d.Sv)(we));else{var t=re()(x.data,we);t.id=we.uid,Me(t.id).then((function(e){e?(console.info("URL exists"),o((0,d.Q$)({multipleTaskList:t,project:Ze}))):(console.info("URL does not exist"),delete we.uid,o((0,d.Sv)(we)))})).catch((function(e){console.error(e)}))}Ge()}return(0,r.useEffect)((function(){x.props.open&&Ke()}),[x.props.open,Ke]),(0,r.useEffect)((function(){qe("task_users",Z)}),[Z]),(0,r.useEffect)((function(){"Asset"===xe&&O&&W(O),"Shot"===xe&&F&&W(F),"Sequence"===xe&&F&&W(L)}),[F,O,L,xe]),(0,r.useEffect)((function(){if(["Sequence","Shot"].includes(xe)){var e,t={uid:null===c||void 0===c||null===(e=c.uid)||void 0===e?void 0:e.split(":")[0].toLowerCase(),entity:"project"};o(je?(0,p.Jy)(t):(0,f.nH)(t))}}),[xe,je]),(0,r.useEffect)((function(){_e(),qe("project",Ze),qe("status",null===ge||void 0===ge?void 0:ge.id);var e={entity:xe};xe&&o((0,j.jG)(e))}),[xe]),(0,r.useEffect)((function(){if(Se){var e={asset_type:Se,uid:Ze,entity:"project"};o((0,h.Vh)(e))}}),[Se]),(0,r.useEffect)((function(){var e={uid:we.episode,entity:"episode"};we.episode&&o((0,f.nH)(e))}),[we.episode]),(0,r.useEffect)((function(){var e={uid:we.sequence,entity:"sequence"};we.sequence&&o((0,v.Sv)(e))}),[we.sequence]),(0,z.jsxs)(Q.Z,(0,k.Z)((0,k.Z)({classes:{paper:"m-24 rounded-8"}},x.props),{},{onClose:Ge,fullWidth:!0,maxWidth:x.type.startsWith("csv")?"md":"xs",children:[(0,z.jsx)(N.Z,{position:"static",className:"shadow-md",children:(0,z.jsxs)(ne.Z,{className:"flex w-full justify-between",children:[(0,z.jsx)(se.Z,{variant:"subtitle1",color:"inherit",children:"new"===x.type?"New Task":"Edit Task"}),(0,z.jsx)(se.Z,{variant:"subtitle1",color:"inherit",children:Ze&&Ze.toUpperCase()})]})}),(0,z.jsxs)("form",{noValidate:!0,onSubmit:Je,className:"flex flex-col md:overflow-hidden",children:[(0,z.jsx)(X.Z,{classes:{root:"p-24"},children:(0,z.jsxs)(z.Fragment,{children:["csvCreate"===x.type&&(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("a",{variant:"contained",color:"secondary",href:ue,download:"SampleCreateTask.csv",children:"Download Sample CSV"})}),"csvUpdate"===x.type&&(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("a",{variant:"contained",color:"secondary",href:oe,download:"SampleUpdateTask.csv",children:"Download Sample CSV"})}),"new"===x.type&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex flex-row mb-8",children:[(0,z.jsx)("div",{className:"flex-1 mr-5",children:(0,z.jsx)(J.Z,{value:xe,onChange:function(e,t){he(t),Be()},disableClearable:!0,id:"entityType",options:["Asset","Shot","Sequence"],renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Entity",required:!0,variant:"outlined"}))}})}),xe&&"Asset"===xe&&(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(J.Z,{value:Se,onChange:function(e,t){ke(t)},disableClearable:!0,id:"assetType",options:["Set","Prop","Character","Vehicle","Fx"],renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Asset Type",required:!0,variant:"outlined"}))}})}),xe&&["Shot","Sequence"].includes(xe)&&je&&(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(J.Z,{value:we.episode,onChange:function(e,t){qe("episode",t)},disableClearable:!0,getOptionLabel:function(e){return e.split(":").slice(-1).join("_")},id:"episode",options:T,renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Episode",required:!0,variant:"outlined"}))}})})]}),xe&&"Shot"===xe&&(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("div",{className:"flex flex-1 mb-8",children:(0,z.jsx)("div",{className:"flex-1 mr-5",children:(0,z.jsx)(J.Z,{value:we.sequence,onChange:function(e,t){qe("sequence",t)},disableClearable:!0,getOptionLabel:function(e){return e.split(":").slice(-1).join("_")},id:"sequence",options:L,renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Sequence",required:!0,variant:"outlined"}))}})})})}),["new","edit","multiple"].includes(x.type)&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex flex-row mb-8",children:[(0,z.jsx)("div",{className:"mr-5 flex-1",children:(0,z.jsx)(J.Z,{value:U,onChange:function(e,t){qe("Asset"===xe?"asset":"Sequence"===xe?"sequence":"shot",t),D(t)},disableClearable:!0,getOptionLabel:function(e){return e.split(":").slice(-1).join()},id:xe,options:K,renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:xe,required:!0,variant:"outlined"}))}})}),(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(J.Z,{value:we.step,onChange:function(e,t){!function(e){We.apply(this,arguments)}(t)},disableClearable:!0,id:"step",options:de,renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Step",required:!0,variant:"outlined"}))}})})]}),(0,z.jsx)("div",{className:"flex flex-row mb-8",children:(0,z.jsx)("div",{className:"mr-5 flex-1",children:(0,z.jsx)(te.Z,{className:"mb-8",label:"Name",autoFocus:!0,id:"name",name:"name",value:we.name,onChange:Ie,variant:"outlined",required:!0,fullWidth:!0,disabled:!0})})})]})]}),"edit"===x.type&&(0,z.jsx)("div",{className:"flex mb-16 justify-center",children:(0,z.jsx)(se.Z,{variant:"subtitle1",color:"secondary",children:we.uid})}),["new","edit","multiple"].includes(x.type)&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"p-4 flex flex-1 mb-8",children:[(0,z.jsx)("div",{className:"flex-1 mr-5",children:(0,z.jsx)(J.Z,{value:Pe&&g[Pe],onChange:function(e,t){Ve(t.id)},disableClearable:!0,id:"users",options:Object.values(g),getOptionLabel:function(e){return e.email},renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Assignee",required:!0,variant:"outlined"}))}})}),(0,z.jsx)("div",{className:"flex mr-5",children:(0,z.jsx)(J.Z,{value:Te,onChange:function(e,t){Le(t)},disableClearable:!0,id:"bids",options:pe,renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Bid",required:!0,variant:"outlined"}))}})}),(0,z.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,z.jsx)("span",{title:"Click To Add New ",children:(0,z.jsx)(ee.Z,{onClick:function(){var e={user:Pe,bid:parseInt(8*parseFloat(Te)*60),step:we.step,task:we.step+":"+we.name,project:we.project,status:null===ge||void 0===ge?void 0:ge.id},t=we.task_users.filter((function(e){return e.user!==Pe}));t=[].concat((0,S.Z)(t),[(0,k.Z)({},e)]),qe("task_users",t),Ve(null),Le(null)},disabled:!Te||!Pe,children:(0,z.jsx)(Y.Z,{children:"add_circle_outline"})})})})]}),(0,z.jsx)("div",{className:"mb-8",children:we.task_users&&we.task_users.length>0&&we.task_users.map((function(e){var t;return(0,z.jsxs)("div",{children:[(0,z.jsxs)(A.ZP,{children:[(0,z.jsx)(B,{children:(0,z.jsx)(G.Z,{src:g[e.user]&&g[e.user].avatar})}),(0,z.jsx)(E.Z,{primary:g[e.user]&&g[e.user].username,secondary:e.bid/480}),(0,z.jsx)(H.Z,{size:"small",variant:"outlined",color:"secondary",children:(null===(t=e.status)||void 0===t?void 0:t.name)||"Ready To Start"}),(0,z.jsx)(_.Z,{title:"Click To Remove",children:(0,z.jsx)(ee.Z,{onClick:function(t){t.stopPropagation(),function(e){var t=we.task_users.filter((function(t){return e.user!==t.user}));qe("task_users",t);var n=we.remove_users?we.remove_users:[];e.id&&qe("remove_users",[].concat((0,S.Z)(n),[e.id]))}(e)},children:(0,z.jsx)(Y.Z,{children:"remove_circle_outline"})})})]},e.user),(0,z.jsx)(q.Z,{variant:"inset"})]},e.user)}))}),(0,z.jsxs)("div",{className:"flex mb-8",children:["new"!=x.type&&(0,z.jsx)("div",{className:"mr-5 flex-1",children:(0,z.jsx)(J.Z,{value:we.status&&b[(null===(i=we.status)||void 0===i?void 0:i.id)||we.status],onChange:function(e,t){qe("status",t.id)},disableClearable:!0,getOptionLabel:function(e){return e.name},id:"status",options:Object.values(b),renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Status",required:!0,variant:"outlined"}))}})}),(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(J.Z,{value:null===we||void 0===we?void 0:we.priority,onChange:function(e,t){qe("priority",t)},disableClearable:!0,id:"priority",options:["low","medium","high"],renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Priority",required:!0,variant:"outlined"}))}})})]}),(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(J.Z,{value:we.reviewer&&g[(null===(a=we.reviewer)||void 0===a?void 0:a.id)||we.reviewer],onChange:function(e,t){qe("reviewer",t.id)},disableClearable:!0,getOptionLabel:function(e){return e.email},id:"reviewer",options:Object.values(g),renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Reviewer",required:!0,variant:"outlined"}))}})})]})]})}),(0,z.jsxs)($.Z,{className:"justify-between pl-16",children:[(0,z.jsx)(H.Z,{variant:"contained",color:"primary",onClick:Je,type:"submit",disabled:!function(){var e;return x.type.startsWith("csv")?Re.length>0:"multiple"===x.type?we.status||(null===(e=we.task_users)||void 0===e?void 0:e.length)||we.reviewer||we.priority:"new"===x.type?we.name:we.uid}(),children:"new"===x.type?"Add":"multiple"===x.type?"Save Selected":"Save"}),(0,z.jsx)(ee.Z,{onClick:Ge,children:(0,z.jsx)(Y.Z,{children:"close"})})]})]})]}))},pe=n(65503),fe=n(76017),ve=n(89600),xe=n(88584);var he=function(e){var t=(0,l.I0)(),n=(0,u.UO)(),i=e.users,a=(0,l.v9)(d.Uq),o=(0,l.v9)((function(e){return e.taskApp.tasks.isLoading})),c=(0,l.v9)((function(e){return e.taskApp.tasks.totalCount})),p=(0,r.useState)(!1),f=(0,s.Z)(p,2),v=f[0],x=f[1],h=(0,r.useState)(""),m=(0,s.Z)(h,2),Z=m[0],j=m[1],g=(0,r.useState)([]),b=(0,s.Z)(g,2),y=b[0],S=b[1],k=(0,r.useState)({pageIndex:0,pageSize:25}),C=(0,s.Z)(k,2),w=C[0],I=C[1];(0,r.useEffect)((function(){!function(){a.length&&x(!0);var e={page_size:w.pageSize,start:w.pageIndex*w.pageSize};e[n.entity]=n.uid,Z&&(e.search=Z);var s=y.length>0&&y.map((function(e){return e.desc?"-"+e.id:e.id}))||[];s.length>0&&(e.ordering=s.join(",")),t((0,d.Ak)(e)),x(!1)}()}),[Z,w.pageIndex,w.pageSize,y,n]),(0,r.useEffect)((function(){I({pageIndex:0,pageSize:25})}),[Z]);var N=r.useMemo((function(){return[{header:"Id",accessorKey:"uid",Cell:function(e){var t=e.cell;return(0,z.jsx)(se.Z,{className:"cursor-pointer",onClick:function(e){e.preventDefault(),pe.Z.push("/entity/task/"+t.getValue()+"/overview")},children:t.getValue()})}},{header:"Name",accessorKey:"name"},{header:"Assignee(s)",accessorKey:"users",Cell:function(e){var t,n=e.cell;return(null===(t=n.getValue())||void 0===t?void 0:t.length)>0?(0,z.jsx)(fe.Z,{max:3,children:n.getValue().map((function(e,t){var n,s;return(0,z.jsx)(_.Z,{title:i&&(null===(n=i[e])||void 0===n?void 0:n.username),placement:"top",children:(0,z.jsx)(G.Z,{src:i&&(null===(s=i[e])||void 0===s?void 0:s.avatar),sx:{width:32,height:32}},t)},t)}))}):(0,z.jsx)("span",{children:" No User "})}},{header:"Bid (in days)",accessorKey:"bid_days"},{header:"Status",accessorKey:"status",size:240,Cell:function(e){var t,n,s=e.cell;return(0,z.jsx)(H.Z,{size:"small",variant:"outlined",sx:{color:null===(t=s.getValue())||void 0===t?void 0:t.color,width:200},children:null===(n=s.getValue())||void 0===n?void 0:n.name})}},{header:"Priority",accessorKey:"priority"},{header:"Start Date",accessorKey:"start_date",Cell:function(e){var t=e.cell;return(0,z.jsx)("span",{children:t.getValue()&&(0,ve.Z)(new Date(t.getValue()),"dd-MM-y hh:mm:ss")})}},{header:"Reviewer",accessorKey:"reviewer.username"},{header:"Created At",accessorKey:"created_at",Cell:function(e){var t=e.cell;return(0,z.jsx)("span",{children:t.getValue()&&(0,ve.Z)(new Date(t.getValue()),"dd-MM-y hh:mm:ss")})}}]}),[i]);return(0,z.jsx)(xe.Z,{columns:N,data:a,onGlobalFilterChange:j,onPaginationChange:I,onSortingChange:S,rowCount:c,state:{globalFilter:Z,isLoading:o,pagination:w,showProgressBars:v,sorting:y},openEditDialog:d.ic,openNewDialog:d.BJ,removeEntities:d._N,openMultipleDialog:d.E6,openCsvCreateDialog:d.rW,openCsvUpdateDialog:d.vf})},me=n(48310),Ze=n(70501);var je=function(e){var t=(0,l.I0)(),n=(0,u.UO)(),i=e.episodeIds,a=e.sequenceIds,o=e.shotIds,c=e.utilSteps,x=e.assetIds,m=n.uid.split(":")[0],Z=(0,r.useState)(null),g=(0,s.Z)(Z,2),b=g[0],y=g[1],S=(0,r.useState)(null),C=(0,s.Z)(S,2),w=C[0],I=C[1],N=(0,r.useState)([]),_=(0,s.Z)(N,2),A=_[0],E=_[1],T=(0,r.useState)([]),L=(0,s.Z)(T,2),F=L[0],O=L[1],P=(0,r.useState)(null),V=(0,s.Z)(P,2),U=V[0],D=V[1],R=(0,r.useState)(null),M=(0,s.Z)(R,2),K=M[0],W=M[1],B=(0,r.useState)(null),G=(0,s.Z)(B,2),H=G[0],Q=G[1];return(0,r.useEffect)((function(){if("Asset"===K&&x&&O(x),"Shot"===K&&o&&O(o),"Sequence"===K&&o&&O(a),["Sequence","Shot"].includes(K)){var e={uid:m,entity:"project"};m&&t((0,p.Jy)(e))}}),[o,x,a,K]),(0,r.useEffect)((function(){D(null),E([]);var e={entity:K};K&&t((0,j.jG)(e))}),[K]),(0,r.useEffect)((function(){if(E([]),H){var e={asset_type:H,uid:m,entity:"project"};t((0,h.Nh)(e))}}),[H]),(0,r.useEffect)((function(){E([]),I(null);var e={uid:b,entity:"episode"};b&&t((0,f.nH)(e))}),[b]),(0,r.useEffect)((function(){E([]);var e={uid:w,entity:"sequence"};w&&t((0,v.Sv)(e))}),[w]),(0,r.useEffect)((function(){var e=[];U&&A.length>0&&(e=A.map((function(e){return[e,U.name].join(":")})),console.log(U,A)),U&&A.length>0&&t((0,d.Ge)(e.length>0?e:void 0))}),[U,A]),(0,z.jsx)("div",{className:"p-0 lg:ltr:pr-4 lg:rtl:pl-4",children:(0,z.jsx)("div",{className:"p-4",children:(0,z.jsxs)(Ze.Z,{className:"rounded-0 shadow-none lg:rounded-8 lg:shadow",children:[(0,z.jsx)("div",{className:"p-8 flex justify-center",children:(0,z.jsx)(se.Z,{color:"secondary",variant:"h6",children:"Task Assignment"})}),(0,z.jsx)(q.Z,{}),(0,z.jsxs)(me.Z,{children:[(0,z.jsx)("div",{className:"p-8 flex flex-col justify-center",children:(0,z.jsx)(J.Z,{value:K,onChange:function(e,t){W(t),y(null),I(null),Q(null)},disableClearable:!0,id:"entityType",options:["Asset","Shot","Sequence"],renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Entity",required:!0,variant:"outlined"}))}})}),K&&"Asset"===K&&(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("div",{className:"p-8 flex flex-col justify-center",children:(0,z.jsx)(J.Z,{value:H,onChange:function(e,t){Q(t)},disableClearable:!0,id:"assetType",options:["Set","Prop","Character","Vehicle","Fx"],renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Asset Type",required:!0,variant:"outlined"}))}})})}),K&&["Sequence","Shot"].includes(K)&&(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("div",{className:"p-8 flex flex-col justify-center",children:(0,z.jsx)(J.Z,{value:b,onChange:function(e,t){y(t)},disableClearable:!0,getOptionLabel:function(e){return e.split(":").slice(1).join("_")},id:"episode",options:i,renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Episode",required:!0,variant:"outlined"}))}})})}),K&&"Shot"===K&&(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("div",{className:"p-8 flex flex-col justify-center",children:(0,z.jsx)(J.Z,{value:w,onChange:function(e,t){I(t)},disableClearable:!0,getOptionLabel:function(e){return e.split(":").slice(-1).join("_")},id:"sequence",options:a,renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Sequence",required:!0,variant:"outlined"}))}})})}),(0,z.jsx)("div",{className:"p-8 flex flex-col justify-center",children:(0,z.jsx)(J.Z,{multiple:!0,limitTags:1,value:A,onChange:function(e,t){E(t)},disableCloseOnSelect:!0,getOptionLabel:function(e){return e.split(":").slice(-1).join("_")},id:K,options:F,renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:K,required:!0,variant:"outlined"}))}})}),(0,z.jsx)("div",{className:"p-8 flex flex-col justify-center",children:(0,z.jsx)(J.Z,{value:U,onChange:function(e,t){D(t)},disableClearable:!0,getOptionLabel:function(e){return e.name},id:"step",options:Object.values(c),renderInput:function(e){return(0,z.jsx)(te.Z,(0,k.Z)((0,k.Z)({},e),{},{label:"Step",required:!0,variant:"outlined"}))}})})]})]})})})};var ge=(0,a.Z)("taskApp",g)((function(e){var t=(0,l.I0)(),n=(0,u.UO)(),a=(0,o.Z)((function(e){return e.breakpoints.down("lg")})),c=(0,r.useState)(!1),p=(0,s.Z)(c,2),f=p[0],v=p[1],x=e.type,h=(0,l.v9)((function(e){return e.taskApp.tasks.taskDialog})),j=(0,l.v9)((function(e){return e.taskApp.tasks.totalCount})),g=(0,l.v9)((function(e){return e.taskApp.tasks.userTasks})),y=(0,l.v9)((function(e){return e.taskApp.tasks.entities})),S=(0,l.v9)((function(e){return e.taskApp.utilSteps.entities})),k=(0,l.v9)((function(e){return e.taskApp.users.entities})),C=(0,l.v9)((function(e){return e.taskApp.status.entities})),w=(0,l.v9)((function(e){return e.taskApp.episodes.ids})),I=(0,l.v9)((function(e){return e.taskApp.sequences.ids})),N=(0,l.v9)((function(e){return e.taskApp.shots.ids})),q=(0,l.v9)((function(e){return e.taskApp.assets.ids})),_=(0,l.v9)((function(e){return e.taskApp.tasks.ids}));return(0,r.useEffect)((function(){"Assignment"===x?(t((0,d.Ge)()),v(!0)):v(!1)}),[x,n]),(0,r.useEffect)((function(){t((0,m.JB)()),t((0,Z.Rf)())}),[]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(i.Z,{header:(0,z.jsx)(b.Z,{entity:"Tasks",totalCount:j}),content:(0,z.jsx)(he,{users:k}),leftSidebarContent:(0,z.jsx)("div",{className:"px-16 py-24",children:(0,z.jsx)(je,{episodeIds:w,sequenceIds:I,shotIds:N,assetIds:q,utilSteps:S})}),leftSidebarOpen:f,leftSidebarWidth:288,leftSidebarOnClose:function(){v(!1)},scroll:a?"normal":"content"}),(0,z.jsx)(de,{taskDialog:h,taskEntities:y,users:k,statuses:C,episodeIds:w,sequenceIds:I,shotIds:N,assetIds:q,userTasks:g,utilSteps:S,taskIds:_})]})}))}}]);