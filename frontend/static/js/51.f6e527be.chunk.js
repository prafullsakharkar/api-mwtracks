"use strict";(self.webpackChunkmwtracks=self.webpackChunkmwtracks||[]).push([[51],{39300:function(e,n,t){t.d(n,{IY:function(){return v},Ls:function(){return b},Nq:function(){return d},Rf:function(){return c},YN:function(){return j},bz:function(){return g},cn:function(){return p},lP:function(){return m},oY:function(){return f},tI:function(){return h}});var r,s=t(4942),i=t(74165),a=t(15861),o=t(80827),u=t(56573),l="/api/v1/account/users/",c=(0,o.hg)("userApp/users/getUsers",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r,s,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.getState,r=null===n||void 0===n?void 0:n.id,s=null===n||void 0===n?void 0:n.entity,a="group"===s&&r?"/api/v1/user/group/"+r+"/users/":"project"===s&&r?"/api/v1/entity/project/"+r+"/users/":l,null===n||void 0===n||delete n.id,null===n||void 0===n||delete n.entity,e.next=8,u.Z.get(a,{params:n}).then((function(e){return e.data})).catch((function(e){console.error(e)}));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),p=(0,o.hg)("userApp/users/addUser",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.getState,delete n.avatar,console.log(n),e.next=5,u.Z.post(l,n);case 5:return r=e.sent,e.next=8,r.data;case 8:return s=e.sent,e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),d=(0,o.hg)("userApp/users/updateUser",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r,s,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.getState,r=n.id,delete n.id,e.next=5,u.Z.patch(l+r+"/",n);case 5:return s=e.sent,e.next=8,s.data;case 8:return a=e.sent,e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),f=(0,o.hg)("userApp/users/addUserToProject",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.dispatch,t.getState,n.projects.forEach((function(e,t){u.Z.post("/api/v1/entity/project/"+e+"/add_users/",n.users).data}));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),v=(0,o.hg)("userApp/users/removeUserFromProjects",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.dispatch,t.getState,n.projects.forEach((function(e,t){u.Z.post("/api/v1/entity/project/"+e+"/remove_users/",n.users).data}));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),h=(0,o.hg)("userApp/users/addUserToGroups",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.dispatch,t.getState,n.users.forEach((function(e,t){u.Z.post(l+e+"/add_groups/",n.groups).data}));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),m=(0,o.hg)("userApp/users/removeUserFromGroups",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.dispatch,t.getState,n.users.forEach((function(e,t){u.Z.post(l+e+"/remove_groups/",n.groups).data}));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),Z=(0,o.hg)("userApp/users/removeUser",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.getState,e.next=3,u.Z.delete(l+n+"/");case 3:return r=e.sent,e.next=6,r.data;case 6:return s=e.sent,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),g=(0,o.hg)("userApp/users/removeUsers",function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.dispatch,t.getState,n.forEach((function(e,n){r(d({id:e,is_active:!1}))}));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),x=(0,o.HF)({}),y=x.getSelectors((function(e){return e.userApp.users})),j=y.selectAll,b=y.selectById,w=(0,o.oM)({name:"userApp/users",initialState:x.getInitialState({totalCount:0,isLoading:!0}),extraReducers:(r={},(0,s.Z)(r,Z.fulfilled,x.removeOne),(0,s.Z)(r,d.fulfilled,x.upsertOne),(0,s.Z)(r,p.fulfilled,x.addOne),(0,s.Z)(r,c.pending,(function(e,n){e.isLoading=!0})),(0,s.Z)(r,c.fulfilled,(function(e,n){var t=n.payload;x.setAll(e,(null===t||void 0===t?void 0:t.results)||t),e.totalCount=(null===t||void 0===t?void 0:t.count)||t.length,e.isLoading=!1})),r)});n.ZP=w.reducer},70051:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var r=t(16554),s=t(5531),i=t(47313),a=t(22408),o=t(30242),u=t(9038),l=t(24613),c=t(99720),p=t(31335),d=t(52418),f=t(65168),v=t(14629),h=t(38954),m=t(94058),Z=t(39300),g=(0,u.UY)({users:Z.ZP,status:h.ZP,utilSteps:m.ZP,versions:l.ZP,episodes:c.ZP,sequences:p.ZP,shots:d.ZP,steps:f.ZP,assets:v.ZP}),x=t(22116),y=t(74165),j=t(15861),b=t(1413),w=t(29439),S=t(83508),A=t(75908),C=t(32729),N=t(31095),V=t(66149),I=t(4117),k=t(96467),_=t(71263),D=t(47131),E=t(30467),q=t(58467),F=t(9289),L=t(61113),P=t(10546),M=t.n(P),U=t(56573),O=(t(49614),t(93433)),z=t(46417);var T=function(e){var n=e.files;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"flex ",children:(0,z.jsxs)("label",{htmlFor:"button-file",className:"flex items-center justify-center relative w-full h-128 rounded-16 mx-12 mb-12 overflow-hidden cursor-pointer shadow hover:shadow-lg",children:[(0,z.jsx)("input",{accept:"image/*",className:"hidden",id:"button-file",type:"file",multiple:e.multiple,onChange:function(t){if(t.target.files[0]){var r=[];Array.from(t.target.files).map((function(e){Array.from(n).length>0?0==Array.from(n).filter((function(n){return n.name===e.name})).length&&r.push(e):r.push(e)})),e.setFiles([].concat((0,O.Z)(n),r))}}}),(0,z.jsx)(_.Z,{fontSize:"large",color:"action",children:"cloud_upload"})]})}),(0,z.jsx)("div",{className:"flex ",children:n.length>0&&(0,z.jsx)("ul",{className:"py-8 px-16 flex flex-wrap list-reset",children:Array.from(n).map((function(t){return(0,z.jsxs)("li",{className:"flex items-center w-full",children:[(0,z.jsx)(_.Z,{color:"action",className:"text-16",children:"photo"}),(0,z.jsx)(L.Z,{children:t.name}),(0,z.jsx)(D.Z,{className:"w-32 h-32 mx-4 p-0","aria-label":"Delete",onClick:function(){return function(t){var r=Array.from(n).filter((function(e){return e.name!==t}));e.setFiles(r)}(t.name)},children:(0,z.jsx)(_.Z,{fontSize:"small",children:"delete"})})]},t.name)}))})})]})},K={status:null,description:""};var B=function(e){var n,t,r,s=(0,a.I0)(),o=(0,q.UO)(),u=e.versionDialog,f=(e.versionEntities,e.statuses),h=e.episodeIds,Z=e.sequenceIds,g=e.shotIds,x=e.assetIds,P=e.versionIds,O=e.utilSteps&&Object.values(e.utilSteps).map((function(e){return e.name}))||[],B=(0,i.useState)([]),H=(0,w.Z)(B,2),W=H[0],R=H[1],Y=(0,i.useState)(null),G=(0,w.Z)(Y,2),J=G[0],Q=G[1],X=(0,i.useState)([]),$=(0,w.Z)(X,2),ee=$[0],ne=$[1],te=(0,i.useState)(null),re=(0,w.Z)(te,2),se=re[0],ie=re[1],ae=(0,a.v9)((function(e){return e.core.projects.entities})),oe=(0,a.v9)((function(e){return e.user.id})),ue=null===o||void 0===o||null===(n=o.uid)||void 0===n?void 0:n.split(":")[0].toLowerCase(),le=ae&&(null===(t=ae[ue])||void 0===t?void 0:t.is_episodic),ce=(0,i.useState)(null),pe=(0,w.Z)(ce,2),de=pe[0],fe=pe[1],ve=(0,S.cI)(K),he=ve.form,me=ve.handleChange,Ze=ve.setForm,ge=ve.setInForm,xe=ve.resetForm,ye=(0,i.useCallback)((function(){xe(),R([]),"edit"===u.type&&u.data&&(Ze((0,b.Z)({},u.data)),ge("updated_by",oe)),"new"===u.type&&(Ze((0,b.Z)((0,b.Z)({},K),u.data)),ge("project",ue),ge("created_by",oe),ge("updated_by",oe))}),[u.data,u.type,Ze]);function je(){return(je=(0,j.Z)((0,y.Z)().mark((function e(n){var t,r,s,i,a,o,u;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge("step",t=J+":"+n),e.prev=2,e.next=5,U.Z.get("/api/v1/entity/steps/"+t+"/versions/");case 5:return r=e.sent,e.next=8,r.data;case 8:s=e.sent,i=s.sort((function(e,n){return n.version_number-e.version_number})),a="Review_v1",i.length>0&&(o=i[0].version_number,u=parseInt(o)+1,a="Review_v"+u,ge("version_number",u)),ge("name",a),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),ge("name",""),console.log("Step Not found ...");case 19:case"end":return e.stop()}}),e,null,[[2,15]])})))).apply(this,arguments)}function be(){ge("name",null),fe(null),Q(null)}function we(){"edit"===u.type?s((0,l.Ie)()):"multiple"===u.type?s((0,l.D7)()):s((0,l.wU)()),be(),ie(null)}function Se(e){if(e.preventDefault(),"multiple"===u.type&&u.data&&u.data.length>0){var n=u.data.map((function(e){var n=M()(K,he);return n.uid=e,n}));s((0,l.nH)({multipleVersionList:n,project:ue}))}else if("new"===u.type)W.length>0&&(he.files=W),s((0,l.l_)(he));else{var t=M()(u.data,he);t.id=he.uid,W.length>0&&(t.files=W),s((0,l.SL)(t))}we()}return(0,i.useEffect)((function(){u.props.open&&ye()}),[u.props.open,ye]),(0,i.useEffect)((function(){}),[u.data]),(0,i.useEffect)((function(){"Asset"===se&&x&&ne(x),"Shot"===se&&g&&ne(g),"Sequence"===se&&g&&ne(Z)}),[g,x,Z,se]),(0,i.useEffect)((function(){if(["Sequence","Shot"].includes(se)){var e,n={uid:null===o||void 0===o||null===(e=o.uid)||void 0===e?void 0:e.split(":")[0].toLowerCase(),entity:"project"};s(le?(0,c.Jy)(n):(0,p.nH)(n))}}),[se,le]),(0,i.useEffect)((function(){var e={entity:se};se&&s((0,m.jG)(e))}),[se]),(0,i.useEffect)((function(){if(de){var e={asset_type:de,uid:ue,entity:"project"};s((0,v.Vh)(e))}}),[de]),(0,i.useEffect)((function(){var e={uid:he.episode,entity:"episode"};he.episode&&s((0,p.nH)(e))}),[he.episode]),(0,i.useEffect)((function(){var e={uid:he.sequence,entity:"sequence"};he.sequence&&s((0,d.Sv)(e))}),[he.sequence]),(0,z.jsxs)(V.Z,(0,b.Z)((0,b.Z)({classes:{paper:"m-24 rounded-8"}},u.props),{},{onClose:we,fullWidth:!0,maxWidth:"xs",children:[(0,z.jsx)(A.Z,{position:"static",className:"shadow-md",children:(0,z.jsxs)(F.Z,{className:"flex w-full justify-between",children:[(0,z.jsx)(L.Z,{variant:"subtitle1",color:"inherit",children:"new"===u.type?"New Version":"multiple"===u.type?"Multiple Versions":"Edit Version"}),(0,z.jsx)(L.Z,{variant:"subtitle1",color:"inherit",children:he.project&&he.project.toUpperCase()})]})}),(0,z.jsxs)("form",{noValidate:!0,onSubmit:Se,className:"flex flex-col md:overflow-hidden",children:[(0,z.jsx)(k.Z,{classes:{root:"p-24"},children:(0,z.jsxs)(z.Fragment,{children:["multiple"!==u.type&&(0,z.jsx)(T,{setFiles:R,files:W,multiple:!0}),"new"===u.type&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex flex-row mb-12",children:[(0,z.jsx)("div",{className:"flex-1 mr-5",children:(0,z.jsx)(C.Z,{value:se,onChange:function(e,n){ie(n),be()},disableClearable:!0,id:"entityType",options:["Asset","Shot","Sequence"],renderInput:function(e){return(0,z.jsx)(E.Z,(0,b.Z)((0,b.Z)({},e),{},{label:"Entity",required:!0,variant:"outlined"}))}})}),se&&"Asset"===se&&(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(C.Z,{value:de,onChange:function(e,n){fe(n)},disableClearable:!0,id:"assetType",options:["Set","Prop","Character","Vehicle","Fx"],renderInput:function(e){return(0,z.jsx)(E.Z,(0,b.Z)((0,b.Z)({},e),{},{label:"Asset Type",required:!0,variant:"outlined"}))}})}),se&&"Shot"===se&&le&&(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(C.Z,{value:he.episode,onChange:function(e,n){ge("episode",n)},disableClearable:!0,getOptionLabel:function(e){return e.split(":").slice(-1).join("_")},id:"episode",options:h,renderInput:function(e){return(0,z.jsx)(E.Z,(0,b.Z)((0,b.Z)({},e),{},{label:"Episode",required:!0,variant:"outlined"}))}})})]}),se&&"Shot"===se&&(0,z.jsx)("div",{className:"mb-12",children:(0,z.jsx)(C.Z,{value:he.sequence,onChange:function(e,n){ge("sequence",n)},disableClearable:!0,getOptionLabel:function(e){return e.split(":").slice(-1).join("_")},id:"sequence",options:Z,renderInput:function(e){return(0,z.jsx)(E.Z,(0,b.Z)((0,b.Z)({},e),{},{label:"Sequence",required:!0,variant:"outlined"}))}})}),(0,z.jsxs)("div",{className:"flex flex-row mb-12",children:[(0,z.jsx)("div",{className:"mr-5 flex-1",children:(0,z.jsx)(C.Z,{value:J,onChange:function(e,n){ge("Asset"===se?"asset":"Sequence"===se?"sequence":"shot",n),Q(n)},disableClearable:!0,getOptionLabel:function(e){return e.split(":").slice(-1).join()},id:se,options:ee,renderInput:function(e){return(0,z.jsx)(E.Z,(0,b.Z)((0,b.Z)({},e),{},{label:se,required:!0,variant:"outlined"}))}})}),(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(C.Z,{value:he.step,onChange:function(e,n){!function(e){je.apply(this,arguments)}(n)},disableClearable:!0,id:"step",options:O,renderInput:function(e){return(0,z.jsx)(E.Z,(0,b.Z)((0,b.Z)({},e),{},{label:"Step",required:!0,variant:"outlined"}))}})})]})]}),"edit"===u.type&&(0,z.jsx)("div",{className:"flex mb-16 justify-center",children:(0,z.jsx)(L.Z,{variant:"subtitle1",color:"secondary",children:he.uid})}),(0,z.jsxs)("div",{className:"flex flex-row mb-12",children:["multiple"!==u.type&&(0,z.jsx)("div",{className:"mr-5 flex-1",children:(0,z.jsx)(E.Z,{className:"mb-12",autoFocus:!0,id:"name",name:"name",value:he.name,onChange:me,variant:"outlined",fullWidth:!0,disabled:!0})}),(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsx)(C.Z,{value:he.status&&f[(null===(r=he.status)||void 0===r?void 0:r.id)||he.status],onChange:function(e,n){ge("status",n.id)},disableClearable:!0,getOptionLabel:function(e){return e.name},id:"status",options:Object.values(f),renderInput:function(e){return(0,z.jsx)(E.Z,(0,b.Z)((0,b.Z)({},e),{},{label:"Status",required:!0,variant:"outlined"}))}})})]}),(0,z.jsx)("div",{className:"flex",children:(0,z.jsx)(E.Z,{className:"mb-12",label:"Description",autoFocus:!0,id:"description",name:"description",value:he.description,onChange:me,variant:"outlined",fullWidth:!0})})]})}),(0,z.jsxs)(I.Z,{className:"justify-between pl-16",children:[(0,z.jsx)(N.Z,{variant:"contained",color:"primary",onClick:Se,type:"submit",disabled:!("new"===u.type?P&&he.step&&he.name&&!P.includes(he.step+":"+he.name)&&W.length>0:he.status||he.description),children:["edit","multiple"].includes(u.type)?"Update":"Create"}),(0,z.jsx)(D.Z,{onClick:we,children:(0,z.jsx)(_.Z,{children:"close"})})]})]})]}))},H=t(65503),W=t(89600),R=t(88584),Y=t(45217);var G=function(e){var n=(0,a.I0)(),t=(0,q.UO)(),r=(0,a.v9)(l.jj),s=(0,a.v9)((function(e){return e.versionApp.versions.isLoading})),o=(0,a.v9)((function(e){return e.versionApp.versions.totalCount})),u=(0,i.useState)(!1),c=(0,w.Z)(u,2),p=c[0],d=c[1],f=(0,i.useState)(""),v=(0,w.Z)(f,2),h=v[0],m=v[1],Z=(0,i.useState)([]),g=(0,w.Z)(Z,2),x=g[0],y=g[1],j=(0,i.useState)({pageIndex:0,pageSize:25}),b=(0,w.Z)(j,2),S=b[0],A=b[1];(0,i.useEffect)((function(){!function(){r.length&&d(!0);var e={page_size:S.pageSize,start:S.pageIndex*S.pageSize};e[t.entity]=t.uid,h&&(e.search=h);var s=x.length>0&&x.map((function(e){return e.desc?"-"+e.id:e.id}))||[];s.length>0&&(e.ordering=s.join(",")),n((0,l.yQ)(e)),d(!1)}()}),[h,S.pageIndex,S.pageSize,x,t]),(0,i.useEffect)((function(){A({pageIndex:0,pageSize:25})}),[h]);var C=i.useMemo((function(){return[{header:"Id",accessorKey:"uid",Cell:function(e){var n=e.row;return(0,z.jsx)(L.Z,{className:"cursor-pointer",onClick:function(e){e.preventDefault(),H.Z.push("/entity/version/"+n.original.uid+"/overview")},children:n.original.uid})}},{header:"Media Files",accessorKey:"media_files",Cell:function(e){var n=e.cell;return n.getValue()?(0,z.jsx)(Y.Z,{media_files:n.getValue()}):null}},{header:"Name",accessorKey:"name"},{header:"Version",accessorKey:"version_number"},{header:"Status",accessorKey:"status",size:240,Cell:function(e){var n,t,r=e.cell;return(0,z.jsx)(N.Z,{size:"small",variant:"outlined",sx:{color:null===(n=r.getValue())||void 0===n?void 0:n.color,width:200},children:null===(t=r.getValue())||void 0===t?void 0:t.name})}},{header:"Description",accessorKey:"description"},{header:"Created By",accessorKey:"created_by.username"},{header:"Created At",accessorKey:"created_at",Cell:function(e){var n=e.cell;return(0,z.jsx)("span",{children:n.getValue()&&(0,W.Z)(new Date(n.getValue()),"dd-MM-y hh:mm:ss")})}},{header:"Updated By",accessorKey:"updated_by.username"}]}),[]);return(0,z.jsx)(R.Z,{columns:C,data:r,onGlobalFilterChange:m,onPaginationChange:A,onSortingChange:y,rowCount:o,state:{globalFilter:h,isLoading:s,pagination:S,showProgressBars:p,sorting:x},openEditDialog:l.Pj,openNewDialog:l.TT,removeEntities:l.WF,openMultipleDialog:l.xu})};var J=(0,s.Z)("versionApp",g)((function(){var e=(0,a.I0)(),n=(0,o.Z)((function(e){return e.breakpoints.down("lg")})),t=(0,a.v9)((function(e){return e.versionApp.versions.versionDialog})),s=(0,a.v9)((function(e){return e.versionApp.versions.ids})),u=(0,a.v9)((function(e){return e.versionApp.versions.totalCount})),l=(0,a.v9)((function(e){return e.versionApp.versions.entities})),c=(0,a.v9)((function(e){return e.versionApp.utilSteps.entities})),p=(0,a.v9)((function(e){return e.versionApp.episodes.ids})),d=(0,a.v9)((function(e){return e.versionApp.sequences.ids})),f=(0,a.v9)((function(e){return e.versionApp.shots.ids})),v=(0,a.v9)((function(e){return e.versionApp.assets.ids})),m=(0,a.v9)((function(e){return e.versionApp.users.entities})),Z=(0,a.v9)((function(e){return e.versionApp.status.entities}));return(0,i.useEffect)((function(){e((0,h.JB)())}),[]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(r.Z,{header:(0,z.jsx)(x.Z,{entity:"Versions",totalCount:u}),content:(0,z.jsx)(G,{users:m,statuses:Z}),scroll:n?"normal":"content"}),(0,z.jsx)(B,{versionDialog:t,versionEntities:l,users:m,statuses:Z,episodeIds:p,sequenceIds:d,shotIds:f,assetIds:v,versionIds:s,utilSteps:c})]})}))},24613:function(e,n,t){t.d(n,{D7:function(){return k},Ie:function(){return V},Pj:function(){return N},SL:function(){return h},TT:function(){return A},WF:function(){return g},bo:function(){return f},jj:function(){return j},jl:function(){return b},l_:function(){return v},nH:function(){return m},wU:function(){return C},xu:function(){return I},yQ:function(){return d}});var r,s=t(4942),i=t(93433),a=t(74165),o=t(1413),u=t(15861),l=t(80827),c=t(56573),p="/api/v1/entity/versions/",d=(0,l.hg)("versionApp/version/getVersions",function(){var e=(0,u.Z)((0,a.Z)().mark((function e(n,t){var r,s,i,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.getState,r=null===n||void 0===n?void 0:n.uid,s=null===n||void 0===n?void 0:n.entity,i=s&&r?"/api/v1/entity/"+s+"s/"+r+"/versions/":p,null===(u=(0,o.Z)({},n))||void 0===u||delete u.uid,null===u||void 0===u||delete u.entity,e.next=9,c.Z.get(i,{params:u}).then((function(e){return e.data})).catch((function(e){return console.error(e),[]}));case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),f=(0,l.hg)("versionApp/version/getVersion",function(){var e=(0,u.Z)((0,a.Z)().mark((function e(n,t){var r,s,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.getState,r=n.uid,e.next=4,c.Z.get(p+r+"/");case 4:return s=e.sent,e.next=7,s.data;case 7:return i=e.sent,e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),v=(0,l.hg)("versionApp/versions/addVersion",function(){var e=(0,u.Z)((0,a.Z)().mark((function e(n,t){var r,s,i,o,u,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.dispatch,t.getState,!(n.files&&n.files.length>0)){e.next=12;break}for(r=new FormData,s=0;s<n.files.length;s++)r.append("files",n.files[s]);return e.next=6,c.Z.post("/api/v1/utility/uploadfiles/",r);case 6:return i=e.sent,e.next=9,i.data;case 9:o=e.sent,n.media_files=o.map((function(e){return e.id})),delete n.files;case 12:return e.next=14,c.Z.post(p,n);case 14:return u=e.sent,e.next=17,u.data;case 17:return l=e.sent,e.abrupt("return",l);case 19:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),h=(0,l.hg)("versionApp/versions/updateVersion",function(){var e=(0,u.Z)((0,a.Z)().mark((function e(n,t){var r,s,o,u,l,d,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.dispatch,t.getState,r=n.id,delete n.id,!(n.files&&n.files.length>0)){e.next=16;break}for(n.media_files=[],s=new FormData,o=0;o<n.files.length;o++)n.files[o].id?n.media_files=[].concat((0,i.Z)(n.media_files),[n.files[o].id]):s.append("files",n.files[o]);if(!s.get("files")){e.next=15;break}return e.next=10,c.Z.post("/api/v1/utility/uploadfiles/",s);case 10:return u=e.sent,e.next=13,u.data;case 13:l=e.sent,n.media_files=[].concat((0,i.Z)(n.media_files),(0,i.Z)(l.map((function(e){return e.id}))));case 15:delete n.files;case 16:return e.next=18,c.Z.patch(p+r+"/",n);case 18:return d=e.sent,e.next=21,d.data;case 21:return f=e.sent,e.abrupt("return",f);case 23:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),m=(0,l.hg)("versionApp/version/updateMultipleVersions",function(){var e=(0,u.Z)((0,a.Z)().mark((function e(n,t){var r,s,i,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.multipleVersionList,s=n.project,t.dispatch,t.getState,e.next=4,c.Z.post("/api/v1/entity/projects/"+s+"/version_bulk_update/",r);case 4:return i=e.sent,e.next=7,i.data;case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),Z=(0,l.hg)("versionApp/versions/removeVersion",function(){var e=(0,u.Z)((0,a.Z)().mark((function e(n,t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.getState,e.next=3,c.Z.delete(p+n+"/").then((function(e){return console.info(e),n})).catch((function(e){console.error(e)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),g=(0,l.hg)("versionApp/version/removeVersions",function(){var e=(0,u.Z)((0,a.Z)().mark((function e(n,t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dispatch,t.getState,confirmAlert({title:"Confirm to delete versions !!!",message:"Are you sure, you want to remove selected versions ?",buttons:[{label:"Yes",onClick:function(){n.map((function(e){r(Z(e))})),r(showMessage({message:"Versions has been removed successfully !"}))}},{label:"No",onClick:function(){return console.log("No action to remove versions")}}]}),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),x=(0,l.HF)({selectId:function(e){return e.uid}}),y=x.getSelectors((function(e){var n,t;return(null===(n=e.versionApp)||void 0===n?void 0:n.versions)||(null===(t=e.overviewApp)||void 0===t?void 0:t.versions)})),j=y.selectAll,b=y.selectById,w=(0,l.oM)({name:"versionApp/versions",initialState:x.getInitialState({totalCount:0,isLoading:!0,versionDialog:{type:"new",props:{open:!1},data:null}}),reducers:{openNewVersionDialog:function(e,n){e.versionDialog={type:"new",props:{open:!0},data:null}},closeNewVersionDialog:function(e,n){e.versionDialog={type:"new",props:{open:!1},data:null}},openEditVersionDialog:function(e,n){e.versionDialog={type:"edit",props:{open:!0},data:n.payload}},closeEditVersionDialog:function(e,n){e.versionDialog={type:"edit",props:{open:!1},data:null}},openMultipleVersionDialog:function(e,n){e.versionDialog={type:"multiple",props:{open:!0},data:n.payload}},closeMultipleVersionDialog:function(e,n){e.versionDialog={type:"multiple",props:{open:!1},data:null}}},extraReducers:(r={},(0,s.Z)(r,Z.fulfilled,(function(e,n){x.removeOne(e,n.payload)})),(0,s.Z)(r,h.fulfilled,(function(e,n){n.payload.length>0?x.upsertMany(e,n.payload):x.upsertOne(e,n.payload)})),(0,s.Z)(r,v.fulfilled,(function(e,n){n.payload.length>0?x.upsertMany(e,n.payload):x.addOne(e,n.payload)})),(0,s.Z)(r,f.fulfilled,(function(e,n){x.upsertOne(e,n.payload)})),(0,s.Z)(r,d.pending,(function(e,n){e.isLoading=!0})),(0,s.Z)(r,d.fulfilled,(function(e,n){var t=n.payload;x.setAll(e,(null===t||void 0===t?void 0:t.results)||t),e.totalCount=(null===t||void 0===t?void 0:t.count)||t.length,e.isLoading=!1})),(0,s.Z)(r,m.fulfilled,(function(e,n){x.upsertMany(e,n.payload)})),r)}),S=w.actions,A=(S.setVersionsSearchText,S.resetVersionsSearchText,S.openNewVersionDialog),C=S.closeNewVersionDialog,N=S.openEditVersionDialog,V=S.closeEditVersionDialog,I=S.openMultipleVersionDialog,k=S.closeMultipleVersionDialog;n.ZP=w.reducer}}]);